<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="scripts/modernizr.js" type="text/javascript"></script>
    <link href="css/index.css" rel="stylesheet" />


    <link rel='stylesheet prefetch' href='http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css'>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript" src="scripts/jquery.1.5.2.min.js"></script>
    <script src="scripts/jquery.alphanum.js"></script>
    <script src="scripts/jquery.jsonp-2.4.0.min.js"></script>
    <script src="scripts/index.js"></script>
</head>
<body>
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header full_with">

                <a class="navbar-brand" href="DashBoard.html">
                    <img id="imgLogo" src="" alt="Logo" style="float:left;" />
                    <span id="lblCompany" style="font-size:x-large" class="loginspan">---</span>
                </a>
                <div class="left_img">
                    <!--<button id="btnLogout" class="logout" type="submit" value="Logout" onclick="return onClick(6);" > <i class="fa fa-sign-out fa-2x"> </i> </button>-->
                    <ul class="menu_login">
                        <li>
                            <button class="logout">
                                <i class="fa fa-bars fa-2x"></i>
                            </button>
                            <ul class="submenu_login">
                                <li>
                                    <a href="UserProfile.html">
                                        <i class="fa fa-user"></i>
                                        User Profile
                                    </a>
                                </li>
                                <li>
                                    <a href="ChangePassword.html">
                                        <i class="fa fa-exchange"></i>

                                        Change  Password
                                    </a>
                                </li>
                                <li>
                                    <a href="#" onclick="return Logout();">
                                        <i class="fa fa-sign-out"></i>
                                        Log Out
                                    </a>
                                </li>

                            </ul>
                        </li>
                    </ul>

                </div>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <!-- /.navbar-collapse -->

        </div><!-- /.container-fluid -->
    </nav>


    <div class="container-fluid ">
        <div class=" row">

            <div class="col-md-12">
                <div class="row clor_prof">
                    <img src="images/profile.png" class="imger" />
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-4">
                <form class="form-horizontal" role="form">

                    <div class="form-group">
                        <div class=" control-label col-sm-6 col-xs-6 testr3"> <b>User Name:</b></div>
                        <div class="col-sm-6 col-xs-6 testr2 ">
                            <label class="control-label col-sm-6" id="lblName"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class=" control-label col-sm-6 col-xs-6 testr3"><b> Full Name: </b></div>
                        <div class="col-sm-6 col-xs-6 testr2">
                            <label class="control-label col-sm-6" id="lblGroup"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-6" for="cpwd">Current password:</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" id="txtCurrentPwd" placeholder="Enter Current  password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-6" for="newpwd">New password:</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" id="txtNewPwd" placeholder="Enter New password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-6" for="repwd">Confirm Password :</label>
                        <div class="col-sm-6">
                            <input type="password" class="form-control" id="txtConfirmPwd" placeholder="Enter Confirm password">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-6 col-xs-6">
                            <div class="btnholder col-sm-offset-4 pull-right">

                                <button class="butsave btn btn-default" onclick="return ChangePassword()" type="button"><i class="icon-save"></i><span>&nbsp;Save</span></button>

                            </div>

                        </div>
                        <div class=" col-sm-6 col-xs-6">
                            <div class="btnholder ">
                                <a href="DashBoard.html" class="butsub btn btn-default">
                                    <!--<button class="butsub btn btn-default" onclick="return Close();" aria-hidden="true" data-dismiss="modal" type="button">-->
                                    <i class=" fa fa-hand-o-left"></i><span>&nbsp;Back</span>
                                    <!--</button>-->
                                </a>


                                <!--<button class="butsub btn btn-default" onclick="return Back();" aria-hidden="true" data-dismiss="modal" type="button"><i class=" icon-remove"></i><span>&nbsp;Back</span></button>-->

                            </div>
                        </div>
                        <label id="lblErr" style="color:red">  </label>
                    </div>
                </form>
            </div>
            <div class="col-md-4"></div>
        </div>


    </div>


    <script type="text/javascript">

        var ip = IPStr();

        window.onload = loadForm();

        function loadForm() {
            $("#lblCompany").text(localStorage.getItem("CompanyName"));
            $("#imgLogo").attr("src", localStorage.getItem("CompanyLogo"));
            $("#lblName").text(localStorage.getItem("uid"));
            $("#lblGroup").text(localStorage.getItem("FullName"));
        }
        //function CheckMandatory() {
        //    MandatoryControl('sp_cpassword', 'txtCurPass');
        //    MandatoryControl('sp_nwpassword', 'txtNewPass');
        //    MandatoryControl('sp_conpassword', 'txtConfPass');
        //}
        function clearall()
        {
            $("#txtConfirmPwd").val("");
            $('#txtCurrentPwd').val("");
            $('#txtNewPwd').val("");
            $("#lblErr").text("");
        }

        function ChangePassword()
        {
            //CheckMandatory();
            $("#lblErr").text("");

            if ($("#txtCurrentPwd").val().trim() == "") {
                $("#lblErr").text("Please enter Current Password");
                $("#txtCurrentPwd").focus();
                return false;
            }

            if ($("#txtNewPwd").val().trim() == "") {
                $("#lblErr").text("Please enter New Password");
                $("#txtNewPwd").focus();
                return false;
            }

            if ($('#txtConfirmPwd').val().trim() == "") {
                $("#lblErr").text("Please enter Confirm Password");
                $('#txtConfirmPwd').focus();
                return false;
            }

            if ($('#txtNewPwd').val().trim() != $('#txtConfirmPwd').val().trim()) {
                $("#lblErr").text("The passwords you typed do not match.Please type and confirm the password again.");
                $('#txtNewPwd').focus();
                return false;
            }

            if ($('#txtNewPwd').val().trim() == $('#txtCurrentPwd').val().trim()) {
                $("#lblErr").text("The password is not changed.Please type New Password.");
                $('#txtNewPwd').focus();
                return false;
            }

            var obj = new Object();

            obj.Change = $("#txtConfirmPwd").val().trim();
            obj.ID = localStorage.getItem("UserID");
          
            $.ajax({
                url: ip + "FeeCollectionService.svc/ChangePassword",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({ objGroup: JSON.stringify(obj) }),
                success: function (data) {
                  
                    if (data.d.trim() != "") {
                        alert("Password Changed Sucessfully...!!!");
                       // $("#lblErr").text(data.d);
                    }
                  
                }
            });
            clearall();
            return false;
        }

        function Logout() {
            LogOut();
            window.location = "index.html";
        }
</script>
    <script src="scripts/bootstrap.js"></script>
    <script src="scripts/index.js"></script>

</body>
</html>